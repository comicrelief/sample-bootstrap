---
platform: linux

image_resource:
  type: docker-image
  source: {repository: comicrelief/lighthouse, tag: "latest"}

inputs:
  - name: repository
    path: repository
  - name: build-tools
    path: build-tools

caches:
  - path: build-tools/node_modules

params:
  AWS_ACCESS_KEY_ID:
  AWS_SECRET_ACCESS_KEY:
  SITE:
  LIGHTHOUSE_BASE_URL:
  S3_BUCKET_PATH:

run:
  path: sh
  args:
   - -c
   - |
     ./scripts/lighthouse/lighthouse.sh
  dir: build-tools
